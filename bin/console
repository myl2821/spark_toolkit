#!/usr/bin/env ruby

require "bundler/setup"
require "spark_toolkit"

# You can add fixtures and/or initialization code here to make experimenting
# with your gem easier. You can also use a different console, if you like.

# (If you use this, don't forget to add pry to your Gemfile!)
# require "pry"
# Pry.start

require "pry"

conf = SparkToolkit::Conf::Configuration.new
conf.add_config_dir("config")
conf["hadoop.security.authentication"] = "kerberos"

hdfs = SparkToolkit::HDFS::FileSystem.new("hdfs://sensetime-data-hadoop-dev", conf)
is = hdfs.open("/user/annoback/yyy.c")

yarn = SparkToolkit::YARN::Client.new conf
yarn.start

app = yarn.get_applications[0]

binding.pry
