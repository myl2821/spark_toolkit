#!/usr/bin/env ruby

require "bundler/setup"
require "spark_toolkit"

# You can add fixtures and/or initialization code here to make experimenting
# with your gem easier. You can also use a different console, if you like.

# (If you use this, don't forget to add pry to your Gemfile!)
# require "pry"
# Pry.start

require "pry"

conf = SparkToolkit::Conf::Configuration.new
conf.add_config_dir("config")
conf["hadoop.security.authentication"] = "kerberos"

buffer = Java::byte[4096].new
hdfs = SparkToolkit::HDFS::FileSystem.new("hdfs://sensetime-data-hadoop-dev", conf)
is = hdfs.open("/user/annoback/packages/1")
rd = SparkToolkit::HDFS::Reader.new(is)

f = File.open 'hehhe.zip', 'w'

iio = is.to_io
IO.copy_stream(iio, f)
#f.write(data)
f.close

binding.pry
